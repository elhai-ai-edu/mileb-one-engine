<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>MilEd.One â€” ×‘×“×™×§×ª ×× ×•×¢</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; padding: 30px; background: #f4f7f6; }
    .card { background: white; padding: 25px; border-radius: 12px; max-width: 600px; margin: auto; box-shadow: 0 4px 15px rgba(0,0,0,0.08); }
    h2 { color: #2c3e50; }
    select, button { padding: 10px 15px; margin: 5px; border-radius: 8px; border: 1px solid #ddd; font-size: 1rem; }
    button { background: #3498db; color: white; border: none; cursor: pointer; }
    button:hover { background: #2980b9; }
    pre { background: #f8f9fa; padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; margin-top: 15px; border: 1px solid #e0e0e0; }
    .status { padding: 8px 12px; border-radius: 6px; margin-top: 10px; font-weight: bold; }
    .ok { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
    .loading { background: #fff3cd; color: #856404; }
  </style>
</head>
<body>
<div class="card">
  <h2>ğŸ”§ ×‘×“×™×§×ª ×× ×•×¢ MilEd.One v2.0</h2>

  <label><strong>×¡×•×’ ×‘×•×˜ ×œ×‘×“×™×§×”:</strong></label><br>
  <select id="botType">
    <option value="socratic_student">×¡×•×§×¨×˜×™ ×œ×¡×˜×•×“× ×˜×™×</option>
    <option value="faculty_assistant">×¢×•×–×¨ ×œ××¨×¦×™×</option>
    <option value="universal_support">×‘×•×˜ ×ª××™×›×”</option>
    <option value="universal_presentation">×‘×•×˜ ××¦×’×•×ª</option>
    <option value="skills_diagnostic">××‘×—×•×Ÿ ××™×•×× ×•×™×•×ª</option>
  </select>

  <br><br>
  <button onclick="testAPI()">â–¶ ×‘×“×•×§ ×—×™×‘×•×¨</button>
  <button onclick="clearResult()" style="background:#95a5a6;">× ×§×”</button>

  <div id="status"></div>
  <pre id="result">×”×ª×•×¦××” ×ª×•×¤×™×¢ ×›××Ÿ...</pre>
</div>

<script>
async function testAPI() {
  const botType = document.getElementById('botType').value;
  const status = document.getElementById('status');
  const result = document.getElementById('result');

  status.className = 'status loading';
  status.textContent = 'â³ ×©×•×œ×— ×‘×§×©×”...';
  result.textContent = '';

  try {
    const res = await fetch('/.netlify/functions/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        message: "×©×œ×•×, ×× ×™ ×¡×˜×•×“× ×˜ ×•×× ×™ ×¦×¨×™×š ×¢×–×¨×” ×‘×”×‘× ×ª ×—×•××¨ ×”×œ×™××•×“.",
        botType: botType,
        studentId: "test-user",
        history: []
      })
    });

    const data = await res.json();

    if (res.ok && data.reply) {
      status.className = 'status ok';
      status.textContent = `âœ… ×ª×©×•×‘×” ×”×ª×§×‘×œ×”! ××•×“×œ: ${data.model || 'gemini'} | ×‘×•×˜: ${data.botName || botType}`;
    } else {
      status.className = 'status error';
      status.textContent = `âŒ ×©×’×™××”: ${data.error || '×ª×©×•×‘×” ×œ× ×ª×§×™× ×”'}`;
    }

    result.textContent = JSON.stringify(data, null, 2);

  } catch (e) {
    status.className = 'status error';
    status.textContent = `âŒ ×©×’×™××ª ×¨×©×ª: ${e.message}`;
    result.textContent = e.toString();
  }
}

function clearResult() {
  document.getElementById('result').textContent = '×”×ª×•×¦××” ×ª×•×¤×™×¢ ×›××Ÿ...';
  document.getElementById('status').textContent = '';
  document.getElementById('status').className = '';
}
</script>
</body>
</html>